"use strict";(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[898],{898:(e,t,s)=>{s.r(t),s.d(t,{default:()=>a});var r=s(5043),i=s(579);const a=function(){const[e,t]=(0,r.useState)(null),[s,a]=(0,r.useState)([]),[d,l]=(0,r.useState)([]),[n,o]=(0,r.useState)([]),[c,x]=(0,r.useState)(!0),[p,h]=(0,r.useState)(null),[f,g]=(0,r.useState)(!0),m=async()=>{try{const e=await fetch("/api/security/stats");if(!e.ok)throw new Error("Error al cargar estad\xedsticas");const s=await e.json();t(s)}catch(e){console.error("Error:",e),h(e.message)}},y=async()=>{try{const e=await fetch("/api/security/alerts");if(!e.ok)throw new Error("Error al cargar alertas");const t=await e.json();a(Array.isArray(t)?t:t.alerts||[])}catch(e){console.error("Error:",e),a([])}},j=async()=>{try{const e=await fetch("/api/security/blocked-users");if(!e.ok)throw new Error("Error al cargar usuarios bloqueados");const t=await e.json();l(Array.isArray(t)?t:[])}catch(e){console.error("Error:",e),l([])}},u=async()=>{try{const e=await fetch("/api/security/events?limit=20");if(!e.ok)throw new Error("Error al cargar eventos");const t=await e.json();o(Array.isArray(t)?t:[])}catch(e){console.error("Error:",e),o([])}},b=async()=>{x(!0),await Promise.all([m(),y(),j(),u()]),x(!1)};(0,r.useEffect)(()=>{b()},[]),(0,r.useEffect)(()=>{if(!f)return;const e=setInterval(()=>{b()},1e4);return()=>clearInterval(e)},[f]);const v=e=>({critical:"#dc3545",high:"#fd7e14",medium:"#ffc107",low:"#6c757d"}[e]||"#6c757d"),k=e=>new Date(e).toLocaleString("es-MX",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});return c&&!e?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"40px"},children:[(0,i.jsx)("i",{className:"fas fa-spinner fa-spin",style:{fontSize:"2em",color:"#007bff"}}),(0,i.jsx)("p",{children:"Cargando estad\xedsticas de seguridad..."})]}):p?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"40px",color:"#dc3545"},children:[(0,i.jsx)("i",{className:"fas fa-exclamation-triangle",style:{fontSize:"2em"}}),(0,i.jsxs)("p",{children:["Error: ",p]}),(0,i.jsx)("button",{onClick:b,className:"btn btn-primary",children:"Reintentar"})]}):(0,i.jsxs)("div",{className:"security-dashboard",children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,i.jsxs)("h2",{style:{margin:0},children:[(0,i.jsx)("i",{className:"fas fa-shield-alt"})," Panel de Seguridad"]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{style:{marginRight:"10px",cursor:"pointer"},children:[(0,i.jsx)("input",{type:"checkbox",checked:f,onChange:e=>g(e.target.checked),style:{marginRight:"5px"}}),"Auto-actualizar"]}),(0,i.jsxs)("button",{onClick:b,className:"btn btn-secondary",children:[(0,i.jsx)("i",{className:"fas fa-sync-alt"})," Actualizar"]})]})]}),e&&(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px",marginBottom:"30px"},children:[(0,i.jsxs)("div",{className:"stat-card",style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"2em",color:"#007bff",marginBottom:"10px"},children:(0,i.jsx)("i",{className:"fas fa-bell"})}),(0,i.jsx)("h3",{style:{margin:0,fontSize:"2em"},children:e.alerts.total}),(0,i.jsx)("p",{style:{margin:"5px 0 0",color:"#6c757d"},children:"Alertas Totales"})]}),(0,i.jsxs)("div",{className:"stat-card",style:{background:"#fff3cd",padding:"20px",borderRadius:"8px",textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"2em",color:"#dc3545",marginBottom:"10px"},children:(0,i.jsx)("i",{className:"fas fa-exclamation-circle"})}),(0,i.jsx)("h3",{style:{margin:0,fontSize:"2em"},children:e.alerts.critical}),(0,i.jsx)("p",{style:{margin:"5px 0 0",color:"#856404"},children:"Alertas Cr\xedticas"})]}),(0,i.jsxs)("div",{className:"stat-card",style:{background:"#f8d7da",padding:"20px",borderRadius:"8px",textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"2em",color:"#fd7e14",marginBottom:"10px"},children:(0,i.jsx)("i",{className:"fas fa-ban"})}),(0,i.jsx)("h3",{style:{margin:0,fontSize:"2em"},children:e.blockedUsers}),(0,i.jsx)("p",{style:{margin:"5px 0 0",color:"#721c24"},children:"Usuarios Bloqueados"})]}),(0,i.jsxs)("div",{className:"stat-card",style:{background:"#d1ecf1",padding:"20px",borderRadius:"8px",textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"2em",color:"#0c5460",marginBottom:"10px"},children:(0,i.jsx)("i",{className:"fas fa-shield-alt"})}),(0,i.jsx)("h3",{style:{margin:0,fontSize:"2em"},children:Object.values(e.events).reduce((e,t)=>e+t,0)}),(0,i.jsx)("p",{style:{margin:"5px 0 0",color:"#0c5460"},children:"Eventos Totales"})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"30px"},children:[(0,i.jsxs)("h3",{children:[(0,i.jsx)("i",{className:"fas fa-exclamation-triangle"})," Alertas Activas (",s.length,")"]}),(0,i.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto",border:"1px solid #dee2e6",borderRadius:"8px",background:"#fff"},children:0===s.length?(0,i.jsxs)("div",{style:{padding:"20px",textAlign:"center",color:"#28a745"},children:[(0,i.jsx)("i",{className:"fas fa-check-circle",style:{fontSize:"2em",marginBottom:"10px"}}),(0,i.jsx)("p",{children:"No hay alertas activas"})]}):(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{style:{background:"#f8f9fa",position:"sticky",top:0},children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Severidad"}),(0,i.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Tipo"}),(0,i.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Detalles"}),(0,i.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Fecha"})]})}),(0,i.jsx)("tbody",{children:s.map((e,t)=>(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #dee2e6"},children:[(0,i.jsx)("td",{style:{padding:"12px"},children:(0,i.jsx)("span",{style:{background:v(e.severity),color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"0.85em",fontWeight:"bold",textTransform:"uppercase"},children:e.severity})}),(0,i.jsx)("td",{style:{padding:"12px"},children:e.type}),(0,i.jsxs)("td",{style:{padding:"12px",fontSize:"0.9em"},children:[JSON.stringify(e.data).substring(0,50),"..."]}),(0,i.jsx)("td",{style:{padding:"12px",fontSize:"0.85em",color:"#6c757d"},children:k(e.createdAt)})]},t))})]})})]}),(0,i.jsxs)("div",{style:{marginBottom:"30px"},children:[(0,i.jsxs)("h3",{children:[(0,i.jsx)("i",{className:"fas fa-user-lock"})," Usuarios Bloqueados (",d.length,")"]}),(0,i.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto",border:"1px solid #dee2e6",borderRadius:"8px",background:"#fff"},children:0===d.length?(0,i.jsxs)("div",{style:{padding:"20px",textAlign:"center",color:"#6c757d"},children:[(0,i.jsx)("i",{className:"fas fa-user-check",style:{fontSize:"2em",marginBottom:"10px"}}),(0,i.jsx)("p",{children:"No hay usuarios bloqueados"})]}):(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{style:{background:"#f8f9fa",position:"sticky",top:0},children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Usuario"}),(0,i.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Raz\xf3n"}),(0,i.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Bloqueado en"}),(0,i.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Expira en"}),(0,i.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Acciones"})]})}),(0,i.jsx)("tbody",{children:d.map((e,t)=>(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #dee2e6"},children:[(0,i.jsx)("td",{style:{padding:"12px",fontWeight:"bold"},children:e.userId}),(0,i.jsx)("td",{style:{padding:"12px",fontSize:"0.9em"},children:e.reason}),(0,i.jsx)("td",{style:{padding:"12px",fontSize:"0.85em",color:"#6c757d"},children:k(e.blockedAt)}),(0,i.jsx)("td",{style:{padding:"12px",fontSize:"0.85em",color:"#6c757d"},children:k(e.expiresAt)}),(0,i.jsx)("td",{style:{padding:"12px"},children:(0,i.jsxs)("button",{onClick:()=>(async e=>{try{if(!(await fetch("/api/security/unblock/".concat(e),{method:"POST"})).ok)throw new Error("Error al desbloquear usuario");await j(),alert("Usuario ".concat(e," desbloqueado exitosamente"))}catch(t){alert("Error: ".concat(t.message))}})(e.userId),className:"btn btn-sm btn-warning",style:{fontSize:"0.85em"},children:[(0,i.jsx)("i",{className:"fas fa-unlock"})," Desbloquear"]})})]},t))})]})})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("h3",{children:[(0,i.jsx)("i",{className:"fas fa-list"})," Eventos Recientes (",n.length,")"]}),(0,i.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto",border:"1px solid #dee2e6",borderRadius:"8px",background:"#fff"},children:0===n.length?(0,i.jsxs)("div",{style:{padding:"20px",textAlign:"center",color:"#6c757d"},children:[(0,i.jsx)("i",{className:"fas fa-inbox",style:{fontSize:"2em",marginBottom:"10px"}}),(0,i.jsx)("p",{children:"No hay eventos recientes"})]}):(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{style:{background:"#f8f9fa",position:"sticky",top:0},children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Tipo"}),(0,i.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Severidad"}),(0,i.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Detalles"}),(0,i.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"2px solid #dee2e6"},children:"Fecha"})]})}),(0,i.jsx)("tbody",{children:n.map((e,t)=>(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #dee2e6"},children:[(0,i.jsx)("td",{style:{padding:"12px"},children:e.type}),(0,i.jsx)("td",{style:{padding:"12px"},children:(0,i.jsx)("span",{style:{background:v(e.severity),color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"0.85em",fontWeight:"bold"},children:e.severity})}),(0,i.jsxs)("td",{style:{padding:"12px",fontSize:"0.9em"},children:[JSON.stringify(e.data).substring(0,60),"..."]}),(0,i.jsx)("td",{style:{padding:"12px",fontSize:"0.85em",color:"#6c757d"},children:k(e.timestamp)})]},t))})]})})]}),e&&e.events&&(0,i.jsxs)("div",{style:{marginTop:"30px"},children:[(0,i.jsxs)("h3",{children:[(0,i.jsx)("i",{className:"fas fa-chart-pie"})," Eventos por Tipo"]}),(0,i.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px"},children:Object.entries(e.events).map(e=>{let[t,s]=e;return(0,i.jsxs)("div",{style:{background:"#f8f9fa",padding:"15px",borderRadius:"8px",textAlign:"center"},children:[(0,i.jsx)("h4",{style:{margin:0,fontSize:"1.5em"},children:s}),(0,i.jsx)("p",{style:{margin:"5px 0 0",color:"#6c757d",fontSize:"0.9em"},children:t.replace(/_/g," ").toUpperCase()})]},t)})})]})]})}}}]);
//# sourceMappingURL=898.83bf13a7.chunk.js.map