"use strict";(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[94],{7094:(e,s,r)=>{r.r(s),r.d(s,{default:()=>v});var a=r(5043),n=r(2110),t=r(6494),i=r(3766),c=r(6605),l=r(5865),o=r(710),d=r(6446),h=r(1637),u=r(4194),j=r(5721),x=r(681),A=r(8569),g=r(1337),f=r(9722),y=r(579);const v=function(){const[e,s]=(0,a.useState)([]),[r,v]=(0,a.useState)(!0),[p,m]=(0,a.useState)(null),[b,C]=(0,a.useState)(!1),w=(0,a.useCallback)(async()=>{if(b||!(e.length>0)){v(!0),m(null);try{const e=await f.A.get("/api/surveys");s(e.data.reverse())}catch(r){console.error("Error fetching survey results:",r),m("No se pudieron cargar los resultados de la encuesta.")}finally{v(!1)}}},[b,e.length]);(0,a.useEffect)(()=>{if(b){w();const e=setInterval(w,3e4);return()=>clearInterval(e)}},[b,w]);const k=(0,a.useMemo)(()=>{if(0===e.length)return{average:0,distribution:{},lowRatings:[]};let s=0;const r={0:0,1:0,2:0,3:0,4:0,5:0},a=[];e.forEach(e=>{s+=e.rating,r[e.rating]++,e.rating<=2&&a.push(e)});return{average:(s/e.length).toFixed(2),distribution:r,lowRatings:a}},[e]),{average:E,distribution:S,lowRatings:R}=k,D=(0,a.useCallback)((e,s)=>{C(s)},[]);return(0,y.jsx)(n.A,{style:{marginTop:"2rem"},children:(0,y.jsx)(t.A,{children:(0,y.jsxs)(i.A,{onChange:D,children:[(0,y.jsx)(c.A,{expandIcon:(0,y.jsx)(g.A,{}),"aria-controls":"survey-results-content",id:"survey-results-header",children:(0,y.jsx)(l.A,{variant:"h5",children:"Dashboard de Resultados de Encuestas"})}),(0,y.jsxs)(o.A,{children:[r&&(0,y.jsx)(d.A,{display:"flex",justifyContent:"center",children:(0,y.jsx)(h.A,{})}),p&&(0,y.jsx)(u.A,{severity:"error",children:p}),!r&&!p&&0===e.length&&(0,y.jsx)(l.A,{children:"No hay resultados de encuestas para mostrar."}),!r&&!p&&e.length>0&&(0,y.jsxs)(d.A,{children:[(0,y.jsx)(l.A,{variant:"h6",children:"Estad\xedsticas Generales"}),(0,y.jsxs)(l.A,{children:["Calificaci\xf3n Promedio: ",E]}),(0,y.jsx)(l.A,{children:"Distribuci\xf3n de Calificaciones:"}),(0,y.jsx)(j.A,{dense:!0,children:Object.entries(S).map(e=>{let[s,r]=e;return(0,y.jsx)(x.Ay,{children:(0,y.jsx)(A.A,{primary:"Calificaci\xf3n ".concat(s,": ").concat(r," veces")})},s)})}),R.length>0&&(0,y.jsxs)(d.A,{mt:2,children:[(0,y.jsx)(l.A,{variant:"h6",color:"error",children:"Calificaciones Bajas (0-2)"}),(0,y.jsx)(j.A,{dense:!0,children:R.map((e,s)=>(0,y.jsx)(x.Ay,{children:(0,y.jsx)(A.A,{primary:"Cliente: ".concat(e.from," - Calificaci\xf3n: ").concat(e.rating),secondary:"Fecha: ".concat(new Date(e.timestamp).toLocaleString())})},s))})]})]})]})]})})})}}}]);
//# sourceMappingURL=94.2c14f790.chunk.js.map